---
interface Props {
	currentPage?: "home" | "explorar" | "categories" | "tags";
}

const { currentPage = "home" } = Astro.props;
---

<header class="sticky top-0 z-50 border-b border-gray-200 bg-white shadow-sm">
	<div class="container mx-auto px-4 py-4">
		<div class="flex items-center justify-between">
			<div class="flex items-center space-x-2 md:space-x-4">
				<a href="/" class="text-2xl font-bold text-gray-900 md:text-3xl">Jessica Things</a>
				<span class="hidden text-sm text-gray-500 sm:inline">Beleza, Moda & Estilo de Vida</span>
			</div>

			<!-- Desktop Navigation -->
			<nav class="hidden space-x-6 md:flex">
				<a
					href="/"
					class:list={[
						"transition-colors",
						currentPage === "home"
							? "font-medium text-gray-900"
							: "text-gray-700 hover:text-gray-900",
					]}
				>
					Início
				</a>
				<a
					href="/explorar"
					class:list={[
						"transition-colors",
						currentPage === "explorar"
							? "font-medium text-gray-900"
							: "text-gray-700 hover:text-gray-900",
					]}
				>
					Explorar
				</a>
				<a
					href="/categories"
					class:list={[
						"transition-colors",
						currentPage === "categories"
							? "font-medium text-gray-900"
							: "text-gray-700 hover:text-gray-900",
					]}
				>
					Categorias
				</a>
				<a
					href="/tags"
					class:list={[
						"transition-colors",
						currentPage === "tags"
							? "font-medium text-gray-900"
							: "text-gray-700 hover:text-gray-900",
					]}
				>
					Tags
				</a>
			</nav>

			<!-- Mobile Menu Button -->
			<button
				id="mobile-menu-btn"
				class="flex items-center justify-center rounded-lg p-2 text-gray-700 transition-colors hover:bg-gray-100 md:hidden"
				aria-label="Toggle menu"
			>
				<svg id="menu-icon" class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M4 6h16M4 12h16M4 18h16"></path>
				</svg>
				<svg
					id="close-icon"
					class="hidden h-6 w-6"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M6 18L18 6M6 6l12 12"></path>
				</svg>
			</button>
		</div>

		<!-- Mobile Navigation -->
		<nav id="mobile-menu" class="hidden overflow-hidden md:hidden">
			<div class="space-y-1 pb-3 pt-4">
				<a
					href="/"
					class:list={[
						"block rounded-lg px-3 py-2 text-base font-medium transition-colors",
						currentPage === "home"
							? "bg-gray-100 text-gray-900"
							: "text-gray-700 hover:bg-gray-100 hover:text-gray-900",
					]}
				>
					Início
				</a>
				<a
					href="/explorar"
					class:list={[
						"block rounded-lg px-3 py-2 text-base font-medium transition-colors",
						currentPage === "explorar"
							? "bg-gray-100 text-gray-900"
							: "text-gray-700 hover:bg-gray-100 hover:text-gray-900",
					]}
				>
					Explorar
				</a>
				<a
					href="/categories"
					class:list={[
						"block rounded-lg px-3 py-2 text-base font-medium transition-colors",
						currentPage === "categories"
							? "bg-gray-100 text-gray-900"
							: "text-gray-700 hover:bg-gray-100 hover:text-gray-900",
					]}
				>
					Categorias
				</a>
				<a
					href="/tags"
					class:list={[
						"block rounded-lg px-3 py-2 text-base font-medium transition-colors",
						currentPage === "tags"
							? "bg-gray-100 text-gray-900"
							: "text-gray-700 hover:bg-gray-100 hover:text-gray-900",
					]}
				>
					Tags
				</a>
			</div>
		</nav>
	</div>
</header>

<script>
	// Mobile menu toggle with iOS compatibility
	const mobileMenuBtn = document.getElementById("mobile-menu-btn");
	const mobileMenu = document.getElementById("mobile-menu");
	const menuIcon = document.getElementById("menu-icon");
	const closeIcon = document.getElementById("close-icon");

	// Prevent scroll when menu is open (iOS fix)
	const toggleMenu = (show: boolean) => {
		if (show) {
			mobileMenu?.classList.remove("hidden");
			menuIcon?.classList.add("hidden");
			closeIcon?.classList.remove("hidden");
			// Prevent body scroll on iOS
			document.body.style.overflow = "hidden";
			document.body.style.position = "fixed";
			document.body.style.width = "100%";
		} else {
			mobileMenu?.classList.add("hidden");
			menuIcon?.classList.remove("hidden");
			closeIcon?.classList.add("hidden");
			// Restore body scroll
			document.body.style.overflow = "";
			document.body.style.position = "";
			document.body.style.width = "";
		}
	};

	mobileMenuBtn?.addEventListener("click", (e) => {
		e.preventDefault();
		e.stopPropagation();
		const isHidden = mobileMenu?.classList.contains("hidden");
		toggleMenu(isHidden || false);
	});

	// Close mobile menu when clicking outside
	document.addEventListener("click", (e) => {
		const target = e.target;
		if (target instanceof Element) {
			if (!target.closest("#mobile-menu-btn") && !target.closest("#mobile-menu")) {
				toggleMenu(false);
			}
		}
	});

	// Close menu when link is clicked
	const menuLinks = mobileMenu?.querySelectorAll("a");
	menuLinks?.forEach((link) => {
		link.addEventListener("click", () => {
			toggleMenu(false);
		});
	});

	// Handle orientation change on iOS
	window.addEventListener("orientationchange", () => {
		if (!mobileMenu?.classList.contains("hidden")) {
			toggleMenu(false);
		}
	});
</script>
